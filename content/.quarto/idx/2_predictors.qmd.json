{"title":"Predictors","markdown":{"headingText":"Predictors","containsRefs":false,"markdown":"\n![](https://img.shields.io/badge/status-not_started-red)\n\n## Categorical predictors (Condition, Group, ...)\n\n![](https://img.shields.io/badge/status-good_for_contributing-blue)\n\nIn the previous chapter, we have mainly focused on the relationship between a response variable and a single **continuous** predictor.\n\n- Contrasts, ...\n\n## Interactions\n\n![](https://img.shields.io/badge/status-good_for_contributing-blue)\n\nTodo. \n\n- Nested interactions (difference between R's formula `fac1 * fac2` and `fac1 / fac2` and how to specify that in Julia/Turing)\n- Use of the `@formula` macro to create the design matrix.\n\n## Ordered predictors (Likert Scales)\n\nLikert scales, i.e., ordered multiple *discrete* choices are often used in surveys and questionnaires. While such data is often treated as a *continuous* variable, such assumption is not necessarily valid. Indeed, distance between the choices is not necessarily equal. For example, the difference between \"strongly agree\" and \"agree\" might not be the same as between \"agree\" and \"neutral\". Even when using integers like 1, 2, 3, 4; people might implicitly process \"4\" as more extreme relative to \"3\" as \"3\" to \"2\".\n\n![](media/probability_perception.png)\n\n> The probabilities assigned to discrete probability descriptors are not necessarily equidistant (https://github.com/zonination/perceptions)\n\n### Monotonic Effects\n\nWhat can we do to better reflect the cognitive process underlying a Likert scale responses? [Monotonic effects](https://cran.r-project.org/web/packages/brms/vignettes/brms_monotonic.html).\n\n- How to do Monotonic effects in Turing?\n\n```\nlibrary(brms)\n\nm <- brm(mpg ~ mo(gear), data = mtcars, refresh=0)\n\n# stancode(m)\nm\n```\n```\n Family: gaussian \n  Links: mu = identity; sigma = identity \nFormula: mpg ~ mo(gear) \n   Data: mtcars (Number of observations: 32) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nIntercept    16.51      1.31    14.01    19.19 1.00     2106     2213\nmogear        3.88      1.02     1.81     5.86 1.00     2160     2315\n\nMonotonic Simplex Parameters:\n           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nmogear1[1]     0.84      0.13     0.52     0.99 1.00     2698     1862\nmogear1[2]     0.16      0.13     0.01     0.48 1.00     2698     1862\n\nFurther Distributional Parameters:\n      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\nsigma     5.02      0.68     3.90     6.58 1.00     2850     2485\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n\n\n```{julia}\n#| code-fold: false\n\n# using Downloads, CSV, DataFrames, Random\n# using Turing, Distributions\n# using GLMakie\n# using LinearAlgebra\n\n# # Define the monotonic function\n# function monotonic(scale::Vector{Float64}, i::Int)\n#     if i == 0\n#         return 0.0\n#     else\n#         return length(scale) * sum(scale[1:i])\n#     end\n# end\n\n# # Test\n# using RDatasets\n# data = dataset(\"datasets\", \"mtcars\")\n\n# # Response variable\n# y = data[!, :MPG]\n# x = data[!, :Gear]\n\n# # Number of observations\n# N = length(y)\n\n# # Length of simplex\n# Jmo = maximum(x)\n\n# # Prior concentration for the simplex (using a uniform prior for simplicity)\n# con_simo_1 = ones(Jmo)\n\n# # Turing Model Specification\n# @model function monotonic_model(y, x, N, Jmo, con_simo_1)\n#     # Parameters\n#     Intercept ~ Normal(19.2, 5.4)\n#     simo_1 ~ Dirichlet(con_simo_1)\n#     sigma ~ truncated(Normal(0, 5.4), 0, Inf)\n#     bsp ~ Normal(0, 1)\n    \n#     # Linear predictor\n#     mu = Vector{Float64}(undef, N)\n#     for n in 1:N\n#         mu[n] = Intercept + bsp * monotonic(simo_1, x[n])\n#     end\n    \n#     # Likelihood\n#     y ~ MvNormal(mu, sigma)\n# end\n\n# # Run the model\n# model = monotonic_model(y, x, N, Jmo, con_simo_1)\n# chain = sample(model, NUTS(), 1000)\n\n# # Display the results\n# display(chain)\n```\n\n\n\n## Non-linear Relationships\n\n![](https://img.shields.io/badge/status-good_for_contributing-blue)\n\n```{julia}\n#| code-fold: false\n\nusing Downloads, CSV, DataFrames, Random\nusing Turing, Distributions\nusing GLMakie\n\nRandom.seed!(123)  # For reproducibility\n\ndf = CSV.read(Downloads.download(\"https://raw.githubusercontent.com/DominiqueMakowski/CognitiveModels/main/data/nonlinear.csv\"), DataFrame)\n\n# Show 10 first rows\nscatter(df.Age, df.SexualDrive, color=:black)\n```\n\n\n### Polynomials \n\nRaw vs. orthogonal polynomials.\n\n### Generalized Additive Models (GAMs)\n\nTodo. ","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":true,"freeze":"auto","echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"execute":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"2_predictors.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","bibliography":["references.bib"],"julia":{"exeflags":["--project=@."]},"theme":"pulse","number-depth":3},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}